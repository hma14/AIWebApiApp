{"ast":null,"code":"var Hub = require('pkghub'),\n  errors = require('./errors'),\n  compile = require('./compile'),\n  hub = new Hub();\nvar isEngine = function (engine) {\n  return typeof engine === 'function';\n};\nvar isRemote = function (dir) {\n  return dir && (dir.indexOf('http') === 0 || dir.indexOf('https') === 0);\n};\n\n// 根据给定的主题名称或者文件名称渲染邮件\n// 不指定引擎渲染的话会自动寻找支持的模板引擎\n// e.g: exports.render('mails-flat/message', {...}, callback);\nmodule.exports = function (template, data, callback, e) {\n  if (!template) return callback(new Error(errors['404']));\n  // 加载本地的模块主题\n  return hub.load(template, function (err, theme, file) {\n    if (err) return callback(new Error(errors['403']));\n    if (!theme) return callback(new Error(errors['403']));\n    if (!theme['view engine']) return callback(new Error(errors['405']));\n    if (!file) return callback(new Error(errors['404']));\n    // 如果匹配不到模板文件，取最相似的第一个\n    var engine = {};\n    var dest = file.exist ? file.dir : file.availables[0];\n    engine.name = theme['view engine'];\n    // 主题相关信息\n    data.Theme = theme;\n    // 渲染页面时要进行 #{static} 变量的替换，这里就是替换成相应主题在 public 下的目录\n    data.static = isRemote(theme.static) ? theme.static : '/' + theme.name;\n    try {\n      engine._engine = isEngine(e) ? e : require(theme['view engine']);\n    } catch (err) {\n      return callback(new Error(errors['405']));\n    }\n    try {\n      return compile(dest, data, engine, callback);\n    } catch (err) {\n      return callback(err);\n    }\n  });\n};","map":{"version":3,"names":["Hub","require","errors","compile","hub","isEngine","engine","isRemote","dir","indexOf","module","exports","template","data","callback","e","Error","load","err","theme","file","dest","exist","availables","name","Theme","static","_engine"],"sources":["E:/programs/AI programs/AIMessageApp/frontend/node_modules/pkghub-render/libs/render.js"],"sourcesContent":["var Hub = require('pkghub'),\n    errors = require('./errors'),\n    compile = require('./compile'),\n    hub = new Hub;\n\nvar isEngine = function(engine) {\n    return typeof(engine) === 'function';\n}\n\nvar isRemote = function(dir) {\n    return dir && (dir.indexOf('http') === 0 || dir.indexOf('https') === 0);\n}\n\n// 根据给定的主题名称或者文件名称渲染邮件\n// 不指定引擎渲染的话会自动寻找支持的模板引擎\n// e.g: exports.render('mails-flat/message', {...}, callback);\nmodule.exports = function(template, data, callback, e) {\n    if (!template) return callback(new Error(errors['404']));\n    // 加载本地的模块主题\n    return hub.load(template, function(err, theme, file) {\n        if (err) return callback(new Error(errors['403']));\n        if (!theme) return callback(new Error(errors['403']));\n        if (!theme['view engine']) return callback(new Error(errors['405']));\n        if (!file) return callback(new Error(errors['404']));\n        // 如果匹配不到模板文件，取最相似的第一个\n        var engine = {};\n        var dest = file.exist ? file.dir : file.availables[0];\n        engine.name = theme['view engine'];\n        // 主题相关信息\n        data.Theme = theme;\n        // 渲染页面时要进行 #{static} 变量的替换，这里就是替换成相应主题在 public 下的目录\n        data.static = isRemote(theme.static) ? theme.static : '/' + theme.name;\n        try {\n            engine._engine = isEngine(e) ? e : require(theme['view engine']);\n        } catch (err) {\n            return callback(new Error(errors['405']));\n        }\n        try {\n            return compile(dest, data, engine, callback);\n        } catch (err) {\n            return callback(err);\n        }\n    });\n};"],"mappings":"AAAA,IAAIA,GAAG,GAAGC,OAAO,CAAC,QAAQ,CAAC;EACvBC,MAAM,GAAGD,OAAO,CAAC,UAAU,CAAC;EAC5BE,OAAO,GAAGF,OAAO,CAAC,WAAW,CAAC;EAC9BG,GAAG,GAAG,IAAIJ,GAAG,CAAD,CAAC;AAEjB,IAAIK,QAAQ,GAAG,SAAAA,CAASC,MAAM,EAAE;EAC5B,OAAO,OAAOA,MAAO,KAAK,UAAU;AACxC,CAAC;AAED,IAAIC,QAAQ,GAAG,SAAAA,CAASC,GAAG,EAAE;EACzB,OAAOA,GAAG,KAAKA,GAAG,CAACC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,IAAID,GAAG,CAACC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;AAC3E,CAAC;;AAED;AACA;AACA;AACAC,MAAM,CAACC,OAAO,GAAG,UAASC,QAAQ,EAAEC,IAAI,EAAEC,QAAQ,EAAEC,CAAC,EAAE;EACnD,IAAI,CAACH,QAAQ,EAAE,OAAOE,QAAQ,CAAC,IAAIE,KAAK,CAACd,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;EACxD;EACA,OAAOE,GAAG,CAACa,IAAI,CAACL,QAAQ,EAAE,UAASM,GAAG,EAAEC,KAAK,EAAEC,IAAI,EAAE;IACjD,IAAIF,GAAG,EAAE,OAAOJ,QAAQ,CAAC,IAAIE,KAAK,CAACd,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;IAClD,IAAI,CAACiB,KAAK,EAAE,OAAOL,QAAQ,CAAC,IAAIE,KAAK,CAACd,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;IACrD,IAAI,CAACiB,KAAK,CAAC,aAAa,CAAC,EAAE,OAAOL,QAAQ,CAAC,IAAIE,KAAK,CAACd,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;IACpE,IAAI,CAACkB,IAAI,EAAE,OAAON,QAAQ,CAAC,IAAIE,KAAK,CAACd,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;IACpD;IACA,IAAII,MAAM,GAAG,CAAC,CAAC;IACf,IAAIe,IAAI,GAAGD,IAAI,CAACE,KAAK,GAAGF,IAAI,CAACZ,GAAG,GAAGY,IAAI,CAACG,UAAU,CAAC,CAAC,CAAC;IACrDjB,MAAM,CAACkB,IAAI,GAAGL,KAAK,CAAC,aAAa,CAAC;IAClC;IACAN,IAAI,CAACY,KAAK,GAAGN,KAAK;IAClB;IACAN,IAAI,CAACa,MAAM,GAAGnB,QAAQ,CAACY,KAAK,CAACO,MAAM,CAAC,GAAGP,KAAK,CAACO,MAAM,GAAG,GAAG,GAAGP,KAAK,CAACK,IAAI;IACtE,IAAI;MACAlB,MAAM,CAACqB,OAAO,GAAGtB,QAAQ,CAACU,CAAC,CAAC,GAAGA,CAAC,GAAGd,OAAO,CAACkB,KAAK,CAAC,aAAa,CAAC,CAAC;IACpE,CAAC,CAAC,OAAOD,GAAG,EAAE;MACV,OAAOJ,QAAQ,CAAC,IAAIE,KAAK,CAACd,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;IAC7C;IACA,IAAI;MACA,OAAOC,OAAO,CAACkB,IAAI,EAAER,IAAI,EAAEP,MAAM,EAAEQ,QAAQ,CAAC;IAChD,CAAC,CAAC,OAAOI,GAAG,EAAE;MACV,OAAOJ,QAAQ,CAACI,GAAG,CAAC;IACxB;EACJ,CAAC,CAAC;AACN,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}